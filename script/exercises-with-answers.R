# Introduction to Data Visualization with ggplot2

# Ben Matthews (University of Edinburgh) and Eilidh Jack (University of Glasgow)

# 2020-06-29


# First load the package we'll need ---------------------------------------

# We have to tell R this before we can use ggplot2

library(tidyverse)


# Load in our data --------------------------------------------------------

# In R <- is called the 'assignment operator'
# you can pronounce it 'gets'
# the thing on the right hand side of the <- is assigned to the name
# on the left hand side

# here we're reading in one data file called 'simd'
# and then a second one called 'simd_2020_shp

# This assumes you have the files saved in a folder called
# 'data' that is a sub-folder of R's current working
# directory

simd <- readRDS(file.path("data", "simd_series.rds"))
simd_2020_shp <- readRDS(file.path("data", "simd_2020_shp.rds"))

# alternatively you can read in the files directly with the commands below

# simd <- readRDS(gzcon(url("https://github.com/benmatthewsed/ui-data-visualization-course/blob/master/data/simd_series.rds?raw=true")))
# simd_2020_shp <- readRDS(gzcon(url("https://github.com/benmatthewsed/ui-data-visualization-course/blob/master/data/simd_2020_shp.rds?raw=true")))

# You can read about SIMD here - https://www2.gov.scot/Topics/Statistics/SIMD


# getting started ---------------------------------------------------------



# 1. our first plot

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point()


# 2.  plot with different variables

ggplot(
  data = simd,
  mapping = aes(x = access, y = crime)
) + 
  geom_point()

# 3. plot with even more different variables

ggplot(
  data = simd,
  mapping = aes(x = overall, y = simd)
) + 
  geom_point()


# 4. plot with two layers

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) + 
  geom_point() + 
  geom_line()


# 5. plot with two layers and a layer-specific aesthetic

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) + 
  geom_point() + 
  geom_line(aes(group = council_area))

# 6. plot with two layers and a layer-specific aesthetic

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) + 
  geom_point() + 
  geom_line(aes(colour = council_area))


# 7. moving the layer-specific aesthetic to global mapping

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime, colour = council_area)
) + 
  geom_point() + 
  geom_line()

# 6. DO NOT DO THIS

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) + 
  geom_point(aes(x = access, y = health)) + 
  geom_line(aes(group = council_area))

# QUESTION: what's so stupid about this plot?

# Take a minute to discuss in your group why
# this is such a bad idea


# 8. fixed values for geom parameters

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point(colour = "blue")


# 9. fixed values for geom parameters; size

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point(size = 2)

# 10. fixed values for geom parameters

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point(size = 2,
             colour = "blue")


# 9. fixed values in call to aes()

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point(aes(colour = "blue", size = 2))

# wait, this... sort of works?



# 11. The neatest parameters: alpha

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point(
    alpha = 0.3
  )


# to see more available options
# go to https://ggplot2.tidyverse.org/reference/
# type ggplot2::geom_ and hit tab
# scroll through the available geoms and try adding them to the plot



# Types of geom -----------------------------------------------------------



# Plot every row ----------------------------------------------------------

# we saw these already!

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point(
    alpha = 0.3
  )


# how about text instead of points?

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_text()


# Plot a summary of data --------------------------------------------------




# one variable 

# note that we're only supplying an x variable here not a y variable!
# ggplot2 calculates the y variables for us

ggplot(
  data = simd,
  mapping = aes(x = overall)
) +
  geom_histogram()


ggplot(
  data = simd,
  mapping = aes(x = crime)
) +
  geom_histogram()

# try changing the bins argument


ggplot(
  data = simd,
  mapping = aes(x = overall)
) +
  geom_histogram(
    bins = 10
  )

# ... and again


ggplot(
  data = simd,
  mapping = aes(x = overall)
) +
  geom_histogram(
    bins = 100
  )

# how about a different geom?

ggplot(
  data = simd,
  mapping = aes(x = overall)
) +
  geom_density()

ggplot(
  data = simd,
  mapping = aes(x = overall)
) +
  geom_density(
    fill = "blue"
  )

ggplot(
  data = simd,
  mapping = aes(x = overall)
) +
  geom_density(
    colour = "blue"
  )


# advanced- why can't you plot geom_density and geom_histogram
# together?
# NB look at the y-axis

# read this answer - https://stackoverflow.com/questions/37404002/geom-density-to-match-geom-histogram-binwitdh
# and try

ggplot(
  data = simd,
  mapping = aes(x = overall)
) +
  geom_histogram(
    bins = 100
  ) +
  geom_density(aes(y=100 * ..count..))



# two variables - geom_smooth ---------------------------------------------

# This is probably the most common two-variable transformation

# "Smoothed conditional means" - i.e. regression line

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_smooth()

# okay, but what about the points?
# we can just add geom_point as another layer!
# and they will both inherit x and y from the call to 
# `aes()`

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_smooth() + 
  geom_point()

# changing the method

# we got a message that
# `geom_smooth()` using method = 'loess' and formula 'y ~ x'

# using the method argument we can change this
# to a bunch of other regression lines!

# linear regression - straight line

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point() + 
  geom_smooth(
    method = "lm"
  )

# a different type of wiggly line: Generalized Additive Model

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point() + 
  geom_smooth(
    method = "gam"
  )

# ADVANCED: look at the different smooth options
# at https://ggplot2.tidyverse.org/reference/geom_smooth.html
# try out a few different ones!



# other settings

# to me this is basically magic already, but because the smooth
# is just another geom you can add aesthetic value just as we
# did before

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point() +
  geom_smooth(
    mapping = aes(colour = region)
  )

# try again with year


ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point() +
  geom_smooth(
    mapping = aes(colour = simd)
  )


# something weird going on there in the East?

# If you want to remove the confidence
# intervals you can with the se parameter
# (but do you want to do this...? Discuss in your group!)

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point() +
  geom_smooth(
    mapping = aes(colour = region),
    se = FALSE
  )


# NB this regression model is calculated inside the ggplot2
# call so you can't (easily) access it
# if you want a complicated smooth, better to fit the model
# outside ggplot2 and then plot the 'smoothed conditional mean'
# based on your own model

# read this - https://socviz.co/modeling.html#modeling
# for more on how

# how about we map colour to a less sensible variable


ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point() +
  geom_smooth(
    mapping = aes(colour = council_area)
  )


# uh oh

# why is this less sensible than mapping to region?



# advanced
# geoms that try to calculate a summary of the data won't work well
# if you give them single data point

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point() +
  geom_smooth(
    mapping = aes(colour = interaction(council_area, simd))
  )



# one continuous one discrete variable -----------------------------------


ggplot(
  data = simd,
  mapping = aes(x = region, y = overall)
) +
  geom_point() + 
  geom_boxplot()





# other two-variable summaries --------------------------------------------


# geom_density_2d

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point() +
  geom_density_2d()

# again we can add more aesthetics

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point() +
  geom_density_2d(
    mapping = aes(colour = region)
  )

# ... maybe not! This is perhaps too much information...


# Plot something else altogether -----------------------------------------------

# we can add a reference line to the previous plot

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point() +
  geom_vline(
    xintercept = 3500
  )

# and a horizontal line

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point() +
  geom_vline(
    xintercept = 3500
  ) +
  geom_hline(
    yintercept = 3500
  )

# how about a diagonal line
# slope = 1 and intercept = 0 is a good idea

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point() +
  geom_vline(
    xintercept = 3500
  ) +
  geom_hline(
    yintercept = 3500
  ) +
  geom_abline(
    slope = 1,
    intercept = 0
  )


# To add a variaable from our dataframe as text we can
# just pass this to the aes(label = ) setting in geom_text

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point() +
  geom_vline(
    xintercept = 3500
  ) +
  geom_hline(
    yintercept = 3500
  ) +
  geom_text(
    aes(label = overall)
  )

# this is a lot of information though...

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point() +
  geom_vline(
    xintercept = 3500
  ) +
  geom_hline(
    yintercept = 3500
  ) +
  geom_text(
    aes(label = council_area)
  )


# we can also add a new dataframe of labels
# and supply this to the data argument of geom_text


# this was a bit mind-bending the first time I did it
# the labels need to have values to the x and y variables
# in our dataset for ggplot2 to plot them - because
# to ggplot2 these labels are treated just like the data
# points that we're mapping to geom_point!

simd_labels <- 
tribble(
  ~overall, ~crime, ~label,
  2250, 2250, "High overall / High crime",
  2250, 5000, "High overall / Low crime",
  5000, 2250, "Low overall / High crime",
  5000, 5000, "Low overall / Low crime"
)

# now plot this directly
# using geom_label(mapping = aes(label =))

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point() +
  geom_vline(
    xintercept = 3500
  ) +
  geom_hline(
    yintercept = 3500
  ) +
  geom_text(
    data = simd_labels,
    mapping = aes(label = label)
  )


# Facets ------------------------------------------------------------------

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point() +
  facet_wrap(
    facets = vars(simd)
  )


# add another variable; region

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point() +
  facet_wrap(
    facets = vars(simd, region)
  )

# NB for facets we use `vars()` not `aes()`

# if we're faceting by two variables
# we can use facet_grid and specify the rows and columns directly
# generally facet_wrap is preferred to facet_grid
# https://ggplot2-book.org/getting-started.html#qplot-facetting



ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point(
    mapping = aes(colour = council_area)
  ) +
  facet_grid(
    rows = vars(simd), 
    cols = vars(region)
  )


# adjusting facet output

# sometimes you want this but beware uneven scales

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point(
    mapping = aes(colour = council_area)
  ) +
  facet_wrap(
    facets = vars(simd, region),
    scales = "free_y"
  )

# DISCUSS:
# why do we have to supply the scales arguments in quotation marks?


# advanced exercises

# look up the facet labeller() function
# add variable labels to your facets
# using an additional data frame of labels
# (see examples here https://ggplot2.tidyverse.org/reference/labeller.html)


# even more advanced reading

# `vars()` is a quoting function like `aes()`
# If you want to understand more about *how* this works, 
# read section IV 'metaprogramming' in Advanced R https://adv-r.hadley.nz/metaprogramming.html
# This probably won't help you use ggplot2 better, but
# it will help you understand how it works its magic, and
# why you have to be very particular with `aes()`



# gg-gotchas --------------------------------------------------------------

# 1. Two joined lines (multiple groups)


ggplot(
  data = simd,
  mapping = aes(x = year, y = overall)
) +
  geom_line()

# why doesn't this work?

# we need to add a grouping variable to make this work
# what grouping variable should we add?

ggplot(
    data = simd,
    mapping = aes(x = year, y = overall, group = council_area)
  ) +
  geom_line()


# 2. Groups == only one observation (categorical x-variable + y-variables)

# we have to fiddle with the data to get this specific error


simd_ed <- 
filter(simd,
       council_area == "City of Edinburgh")

# now we get an error if we try to use SIMD sweep as the x variable

ggplot(
    data = simd_ed,
    mapping = aes(x = simd,
                  y = overall)
  ) +
  geom_line()

# we can remove this by setting the group explicitly again

ggplot(
  data = simd_ed,
  mapping = aes(x = simd,
                y = overall,
                group = council_area)
) +
  geom_line()


# we get the same plot if we group by region instead of council
# area

ggplot(
  data = simd_ed,
  mapping = aes(x = simd,
                y = overall,
                group = region)
) +
  geom_line()

# why is this?
# ... because they're 100% correlated - Edinburgh is always
# in the East region (in our dataset at least)


# 3. Stat count y aesthetic

simd_2020 <- 
  filter(simd,
         year == 2020)

# if we want to plot the median overall SIMD for 2020
# with a bar we get an error

ggplot(
  data = simd_2020,
  mapping = aes(x = council_area,
                y = overall)
) +
  geom_bar()

# we can override this by passing stat = "identity"
# to geom_bar

ggplot(
  data = simd_2020,
  mapping = aes(x = council_area,
                y = overall)
) +
  geom_bar(stat = "identity")



# 4. + on newline

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) 
+ geom_point()


# 5. Call inside/outside `aes()`

# run the following four sets of code and
# discuss the differences in outputs with your group


ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
 geom_point(
   aes(colour = region)
 )

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point(
    aes(colour = "region")
  )

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point(
    colour = "region"
  )

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point(
    colour = region
  )

# how about this example?

# why do these two give different results?

# and why does the first example 'work'?

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point(
    aes(size = 2)
  )

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point(
    size = 2
  )

# Session Two -------------------------------------------------------------

# 2020-07-06

# what's in my spatial data frame -----------------------------------------


library(sf)

glimpse(simd_2020_shp)



# maps and coordinates ----------------------------------------------------


st_crs(simd_2020_shp)

# basic plot

ggplot(
  data = simd_2020_shp,
  mapping = aes(geometry = geometry)
) +
  geom_sf()


# we can get rid of the solid grey
# note that the NA here isn't inside aes() - like setting
# the fill to be "red"

ggplot(
  data = simd_2020_shp,
  mapping = aes(geometry = geometry)
) +
  geom_sf(
    fill = NA
  )

# we can make cholropleth maps by mapping fill to variables

ggplot(
  data = simd_2020_shp,
  mapping = aes(geometry = geometry)
) +
  geom_sf(
    mapping = aes(colour = overall)
  )


# oh yeah mapping to fill

ggplot(
  data = simd_2020_shp,
  mapping = aes(geometry = geometry)
) +
  geom_sf(
    mapping = aes(fill = overall)
  )

# and now with crime domain

ggplot(
  data = simd_2020_shp,
  mapping = aes(geometry = geometry)
) +
  geom_sf(
    mapping = aes(fill = crime)
  )



# here's the fun bit - we can add layers like any other ggplot
# because we have latitude and longitude in the dataset
# we can map these to x and y and use other geoms like geom_point

ggplot(
  data = simd_2020_shp,
  mapping = aes(geometry = geometry)
) +
  geom_sf(
    mapping = aes(fill = overall)
  ) +
  geom_point(
    mapping = aes(x = long, y = lat, colour = crime)
  )

# note - now we get labelled axes from geom_point

# we can add in size as well

ggplot(
  data = simd_2020_shp,
  mapping = aes(geometry = geometry)
) +
  geom_sf(
    mapping = aes(fill = overall)
  ) +
  geom_point(
    mapping = aes(x = long, y = lat, colour = crime)
  )

# we can apply all the other ggplot2 features as well

ggplot(
  data = simd_2020_shp,
  mapping = aes(geometry = geometry)
) +
  geom_sf(
    mapping = aes(fill = overall)
  ) +
  facet_wrap(
    facets = vars(region)
  )



# bad maps ----------------------------------------------------------------

# ... what?

ggplot(
  data = simd_2020_shp,
  mapping = aes(geometry = geometry)
) +
  geom_sf(
    mapping = aes(fill = overall)
  ) +
  geom_smooth(
    mapping = aes(x = long, y = lat)
  )


# now with lm

ggplot(
  data = simd_2020_shp,
  mapping = aes(geometry = geometry)
) +
  geom_sf(
    mapping = aes(fill = overall)
  ) +
  geom_smooth(
    mapping = aes(x = long, y = lat),
    method = "lm"
  )

# ... what?

ggplot(
  data = simd_2020_shp,
  mapping = aes(geometry = geometry)
) +
  geom_sf(
    mapping = aes(fill = overall)
  ) +
  geom_point(
    mapping = aes(x = long, y = lat)
  ) +
  geom_smooth(
    mapping = aes(x = long, y = lat)
  )

# why stop at long and lat?

ggplot(
  data = simd_2020_shp,
  mapping = aes(geometry = geometry)
) +
  geom_sf(
    mapping = aes(fill = overall)
  ) +
  geom_point(
    mapping = aes(x = crime, y = health)
  )

# the gridlines are gone because... they're graticules (or rather, they're only
# in the sensible range of graticules for Earth)

# it's hard to remember which one is lat and which is long


ggplot(
  data = simd_2020_shp,
  mapping = aes(geometry = geometry)
) +
  geom_sf(
    mapping = aes(fill = overall)
  ) +
  geom_point(
    mapping = aes(x = lat, y = long)
  )





# colour palettes ---------------------------------------------------------

# we've seen ggplot2's defualt colour scales already

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point(
    mapping = aes(colour = region)
  )

# In general I use viridis palettes in my plots

# here region is discrete so I need scale_colour_viridis_d

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point(
    mapping = aes(colour = region)
  ) +
  scale_colour_viridis_d()


# how about a continuous measure?

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point(
    mapping = aes(colour = year)
  ) +
  scale_colour_viridis_c()

# what happens if you use *_viridis_c with a discrete measure?

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point(
    mapping = aes(colour = simd)
  ) +
  scale_colour_viridis_c()


# try with scale_colour_grey

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point(
    mapping = aes(colour = simd)
  ) +
  scale_colour_grey()

# ADVANCED
# reproduce the plot with x = overall and y = crime
# and colour = region
# create a custom colour scale for the plot using
# scale_colour_manual

# If you're not familiar with the c() function
# take a look here - https://stackoverflow.com/a/11488864/10791377


ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point(
    mapping = aes(colour = region)
  ) +
  scale_colour_manual(values = c("red", "green", "pink"))

# ADVANCED
# make your own greyscale continous plot using scale_colour_gradient
# mapping colour to access

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point(
    mapping = aes(colour = access)
  ) +
  scale_colour_gradient(
    low = "white",
    high = "black"
  )

# one of the tricky things is knowing whether a geom wants
# colour or fill (or both) - we saw this with one of our maps

# we can remove the borders on the map by adding colour = overall

ggplot(
  data = simd_2020_shp,
  mapping = aes(geometry = geometry)
) +
  geom_sf(
    mapping = aes(fill = overall,
                  colour = overall)
  )

# how change colour to viridis

ggplot(
  data = simd_2020_shp,
  mapping = aes(geometry = geometry)
) +
  geom_sf(
    mapping = aes(fill = overall,
                  colour = overall)
  ) +
  scale_colour_viridis_c()


# we also need to change fill to viridis


ggplot(
  data = simd_2020_shp,
  mapping = aes(geometry = geometry)
) +
  geom_sf(
    mapping = aes(fill = overall,
                  colour = overall)
  ) +
  scale_colour_viridis_c() +
  scale_fill_viridis_c()


# annotations and titles --------------------------------------------------


# why doesn't this need a call to `aes()`


# 14. ADVANCED why doesn't this work?


# we saw reference lines previously

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point() +
  geom_vline(
    xintercept = 3000
  )


# why doesn't this work?

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point() +
  geom_vline(
    xintercept = mean(overall)
  )

# ... and why *does* this work?

ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_point() +
  geom_vline(
    xintercept = mean(simd$overall)
  ) +
  geom_hline(
    yintercept = mean(simd$overall)
  ) +
  coord_fixed() +
  geom_abline(
    slope = 1, intercept = 0
  )

# annotations on the plot

labels <- 
  tribble(
    ~overall, ~crime, ~label,
    2000, 2500, "High overall-High crime",
    2000, 5000, "High overall-Low crime",
    5000, 2500, "Low overall-High crime",
    5000, 5000, "Low overall-Low crime"
  )



# adding titles -----------------------------------------------------------


ggplot(
  data = simd,
  mapping = aes(x = overall, y = crime)
) +
  geom_text(
    mapping = aes(label = council_area),
    alpha = 0.3
  ) +
  labs(
    title = "Great title",
    subtitle = "Better subtitle",
    caption = "Best caption",
    x = "Median Overall SIMD Rank",
    y = "Median Crime SIMD Rank"
  )



# publication-ready plots -------------------------------------------------


# themes -----------------------------------------------------------------

# rearrange the code below to a valid ggplot call
# and then add a call to theme_minimal() to change the theme

aes(x = overall, y = crime)
simd,
  data = 
ggplot(
  mapping = 
  geom_point() +
) +


# how about another one: change the theme for the plot above
# to theme_bw()



# and a third: now change the theme call to theme_dark()

# adjusting the legend position
# write a call to produce a scatterplot mapping
# x to overall SIMD, y to crime SIMD and colour to access SIMD
# change the theme to theme_dark
# adjust the call below to set the legend position to "bottom"


  theme(
    legend.position = 
  )

# on second thoughts, maybe the legend is better at the top :-)
# adjust the call so the legend is at the top of the plot

# adjust the below to produce a valid ggplot2 call mapping
# x to overall SIMD, y to crime SIMD and colour to access SIMD,
# with a dark them, the legend at t he top of the plot and
# and the x axis rotated to a 45 degree angle

ggplot(
  data = ,
  mapping = aes(x = overall, y = )
) +
  geom_point(aes(colour = access)) +
  theme_dark() +
  theme(
    legend.position = " ",
    axis.text.x = element_text(angle = , hjust = 1)
  )



# saving your plots -------------------------------------------------------

# save your ggplot above by assigning it to the plot_to_save using
# the <- assignment operator


plot_to_save <- 


# save the plot using ggsave()
# where you save it will depend on the structure of your working
# directory. If you're not familiar with the term 'working directory'
# read this chapter for R4DS 
# https://r4ds.had.co.nz/workflow-projects.html#where-does-your-analysis-live

# use file.path() in the below to save your plot as a png file
# for extra points, 
# add extra arguments as necessary to save your plot
# in a sub-directory called "figures" (you might
# have to create this yourself)
# For how to create a sub-directory in R
# see here - http://theautomatic.net/2018/07/11/manipulate-files-r/
# ... or for tidyverse file manipulation see here - https://fs.r-lib.org/



ggsave(
  filename = file.path(" .png"),
  plot = plot_to_save
)

# save the same plot but with a new filename and set
# type = "cairo-png"
# does this look different? (The answer may be no!)


ggsave(
  filename = file.path(" .png"),
  plot = plot_to_save,
  type = 
)


# can't we make the plot bigger?
# by default height and width are the output size in inches
# set the output height to be 8 inches and width to be 6 inches
# again, save this plot with a different name


ggsave(
 
  plot = ,
  type = "cairo-png",
  height = , 
  width = 
)

